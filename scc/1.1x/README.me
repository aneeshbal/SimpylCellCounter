UPDATED from 1x to include model_on_batch function when calculating overlapping contours
